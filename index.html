<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tourist Safety Management System</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Login Section */
        .login-section {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 400px;
        }

        .login-box h2 {
            color: #667eea;
            margin-bottom: 30px;
            text-align: center;
        }

        .role-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .role-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .role-btn.active {
            background: #667eea;
            color: white;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Dashboard Section */
        .dashboard-section {
            display: none;
        }

        .header {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #667eea;
            font-size: 24px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logout-btn {
            padding: 10px 20px;
            background: #ff5252;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .stat-box {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .stat-box .value {
            font-size: 32px;
            font-weight: bold;
        }

        #map {
            height: 400px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .alert-item {
            padding: 15px;
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .alert-item.high {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .alert-item.medium {
            background: #fff3cd;
            border-left-color: #ffc107;
        }

        .alert-item.low {
            background: #d1ecf1;
            border-left-color: #17a2b8;
        }

        /* Tourist Section */
        .safety-score {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .safety-score .score {
            font-size: 64px;
            font-weight: bold;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .action-btn {
            padding: 20px;
            background: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .action-btn:hover {
            transform: translateY(-3px);
        }

        .action-btn .icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .sos-btn {
            background: #dc3545 !important;
            color: white;
            font-size: 24px;
            font-weight: bold;
        }

        /* Forms */
        .form-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: inherit;
            resize: vertical;
            min-height: 100px;
        }

        .list-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .badge {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge.success {
            background: #d4edda;
            color: #155724;
        }

        .badge.warning {
            background: #fff3cd;
            color: #856404;
        }

        .badge.danger {
            background: #f8d7da;
            color: #721c24;
        }

        .hidden {
            display: none !important;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Login Section -->
    <div id="loginSection" class="login-section">
        <div class="login-box">
            <h2>üõ°Ô∏è Tourist Safety System</h2>
            
            <div class="role-selector">
                <button class="role-btn active" data-role="tourist">üë§ Tourist</button>
                <button class="role-btn" data-role="authority">üöî Authority</button>
            </div>

            <div class="input-group">
                <label>Email</label>
                <input type="email" id="loginEmail" placeholder="Enter your email">
            </div>

            <div class="input-group">
                <label>Password</label>
                <input type="password" id="loginPassword" placeholder="Enter your password">
            </div>

            <button class="btn" id="loginBtn">Login</button>
            
            <div style="margin-top: 15px; text-align: center; color: #666; font-size: 14px;">
                <span>Don't have an account? <a href="#" id="showSignup" style="color: #667eea; text-decoration: none;">Sign up</a></span>
                <span style="margin: 0 10px;">|</span>
                <span><a href="#" id="showForgotPassword" style="color: #667eea; text-decoration: none;">Forgot Password?</a></span>
            </div>
        </div>
    </div>

    <!-- Signup Section -->
    <div id="signupSection" class="login-section" style="display: none;">
        <div class="login-box">
            <h2>üìù Create Account</h2>
            
            <div class="role-selector">
                <button class="role-btn active" data-role="tourist">üë§ Tourist</button>
                <button class="role-btn" data-role="authority">üöî Authority</button>
            </div>

            <div class="input-group">
                <label>Full Name</label>
                <input type="text" id="signupName" placeholder="Enter your full name">
            </div>

            <div class="input-group">
                <label>Email</label>
                <input type="email" id="signupEmail" placeholder="Enter your email">
            </div>

            <div class="input-group">
                <label>Password</label>
                <input type="password" id="signupPassword" placeholder="Enter password (min 6 characters)">
            </div>

            <div class="input-group">
                <label>Confirm Password</label>
                <input type="password" id="signupConfirmPassword" placeholder="Confirm your password">
            </div>

            <button class="btn" id="signupBtn">Create Account</button>
            
            <div style="margin-top: 15px; text-align: center; color: #666; font-size: 14px;">
                <span>Already have an account? <a href="#" id="showLogin" style="color: #667eea; text-decoration: none;">Login</a></span>
            </div>
        </div>
    </div>

    <!-- Forgot Password Section -->
    <div id="forgotPasswordSection" class="login-section" style="display: none;">
        <div class="login-box">
            <h2>üîë Reset Password</h2>
            
            <p style="text-align: center; color: #666; margin-bottom: 20px; font-size: 14px;">
                Enter your email and we'll send you a link to reset your password.
            </p>

            <div class="input-group">
                <label>Email</label>
                <input type="email" id="resetEmail" placeholder="Enter your email">
            </div>

            <button class="btn" id="resetBtn">Send Reset Link</button>
            
            <div style="margin-top: 15px; text-align: center; color: #666; font-size: 14px;">
                <span>Remember your password? <a href="#" id="backToLogin" style="color: #667eea; text-decoration: none;">Login</a></span>
            </div>
        </div>
    </div>

    <!-- Authority Dashboard -->
    <div id="authorityDashboard" class="dashboard-section">
        <div class="container">
            <div class="header">
                <h1>üöî Authority Dashboard</h1>
                <div class="user-info">
                    <span id="authorityUserName">Authority User</span>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="card">
                    <h3>üìä Statistics</h3>
                    <div class="stat-box">
                        <div>
                            <div style="font-size: 14px; opacity: 0.9;">Active Tourists</div>
                            <div class="value" id="activeTourists">0</div>
                        </div>
                        <div style="font-size: 48px;">üë•</div>
                    </div>
                    <div class="stat-box">
                        <div>
                            <div style="font-size: 14px; opacity: 0.9;">Active Alerts</div>
                            <div class="value" id="activeAlerts">0</div>
                        </div>
                        <div style="font-size: 48px;">‚ö†Ô∏è</div>
                    </div>
                    <div class="stat-box">
                        <div>
                            <div style="font-size: 14px; opacity: 0.9;">Incidents Today</div>
                            <div class="value" id="incidentsToday">0</div>
                        </div>
                        <div style="font-size: 48px;">üö®</div>
                    </div>
                </div>

                <div class="card" style="grid-column: span 2;">
                    <h3>üó∫Ô∏è Live Tourist Map</h3>
                    <div id="map"></div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="card" style="grid-column: span 3;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3>üë• Tourist Management</h3>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="searchTourist" placeholder="Search tourists..." style="padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                            <select id="filterStatus" style="padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                                <option value="all">All Status</option>
                                <option value="active">Active</option>
                                <option value="sos">SOS Alert</option>
                            </select>
                            <button class="btn" onclick="exportTouristData()" style="padding: 8px 15px;">üì• Export</button>
                        </div>
                    </div>
                    <div id="touristsList">
                        <div class="loading">Loading tourists...</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="card" style="grid-column: span 2;">
                    <h3>‚ö†Ô∏è Recent Alerts</h3>
                    <div id="alertsList">
                        <div class="loading">Loading alerts...</div>
                    </div>
                </div>

                <div class="card">
                    <h3>üì¢ Broadcast Alert</h3>
                    <div class="input-group">
                        <label>Alert Title</label>
                        <input type="text" id="alertTitle" placeholder="Enter alert title">
                    </div>
                    <div class="input-group">
                        <label>Message</label>
                        <textarea id="alertMessage" placeholder="Enter alert message"></textarea>
                    </div>
                    <div class="input-group">
                        <label>Severity</label>
                        <select id="alertSeverity" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                    <button class="btn" onclick="broadcastAlert()">Broadcast Alert</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Tourist Dashboard -->
    <div id="touristDashboard" class="dashboard-section">
        <div class="container">
            <div class="header">
                <h1>üõ°Ô∏è Tourist Safety</h1>
                <div class="user-info">
                    <span id="touristUserName">Tourist User</span>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="safety-score">
                <div style="font-size: 20px; margin-bottom: 10px;">Your Safety Score</div>
                <div class="score" id="safetyScore">85%</div>
                <div style="font-size: 16px; margin-top: 10px;">You're in a relatively safe area</div>
            </div>

            <div class="quick-actions">
                <button class="action-btn sos-btn" onclick="sendSOS()">
                    <div class="icon">üö®</div>
                    <div>SOS</div>
                </button>
                <button class="action-btn" onclick="showSection('safety')">
                    <div class="icon">üìä</div>
                    <div>Safety Info</div>
                </button>
                <button class="action-btn" onclick="showSection('emergency')">
                    <div class="icon">üìû</div>
                    <div>Emergency</div>
                </button>
                <button class="action-btn" onclick="showSafetyTips()">
                    <div class="icon">üìö</div>
                    <div>Safety Tips</div>
                </button>
                <button class="action-btn" onclick="showSection('itinerary')">
                    <div class="icon">üìÖ</div>
                    <div>My Plans</div>
                </button>
            </div>

            <div class="card" style="grid-column: span 3;">
                <h3>üó∫Ô∏è My Location & Nearby Places</h3>
                <div id="touristMap" style="height: 350px; border-radius: 10px; margin-top: 15px;"></div>
                <div style="margin-top: 15px; display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn" onclick="findNearbyOnMap('hospital')" style="padding: 8px 15px; flex: 1; min-width: 120px;">üè• Hospitals</button>
                    <button class="btn" onclick="findNearbyOnMap('police')" style="padding: 8px 15px; flex: 1; min-width: 120px;">üöî Police</button>
                    <button class="btn" onclick="findNearbyOnMap('tourist_attraction')" style="padding: 8px 15px; flex: 1; min-width: 120px;">üèõÔ∏è Tourist Spots</button>
                    <button class="btn" onclick="findNearbyOnMap('restaurant')" style="padding: 8px 15px; flex: 1; min-width: 120px;">üçΩÔ∏è Restaurants</button>
                    <button class="btn" onclick="centerTouristMap()" style="padding: 8px 15px; flex: 1; min-width: 120px;">üìç My Location</button>
                </div>
            </div>

            <div class="card">
                <h3>‚ö†Ô∏è Active Alerts</h3>
                <div id="touristAlertsList">
                    <div class="loading">Loading alerts...</div>
                </div>
            </div>

            <div class="card" style="grid-column: span 2;">
                <h3>üìÖ My Itinerary</h3>
                <div style="margin-bottom: 15px;">
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <input type="text" id="itineraryPlace" placeholder="Place name" style="flex: 2; min-width: 150px; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                        <input type="date" id="itineraryDate" style="flex: 1; min-width: 120px; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                        <input type="time" id="itineraryTime" style="flex: 1; min-width: 100px; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                        <button class="btn" onclick="addItineraryItem()" style="padding: 8px 15px;">‚ûï Add</button>
                    </div>
                </div>
                <div id="itineraryList">
                    <div class="loading">Loading itinerary...</div>
                </div>
            </div>

            <!-- Safety Info Section -->
            <div id="safetySection" class="form-section hidden">
                <h3>üìä Safety Information</h3>
                <div style="margin-top: 20px;">
                    <div class="list-item">
                        <span><strong>Location Safety:</strong> Good</span>
                        <span class="badge success">90%</span>
                    </div>
                    <div class="list-item">
                        <span><strong>Crime Rate:</strong> Low</span>
                        <span class="badge success">85%</span>
                    </div>
                    <div class="list-item">
                        <span><strong>Traffic Safety:</strong> Moderate</span>
                        <span class="badge warning">75%</span>
                    </div>
                    <div class="list-item">
                        <span><strong>Health Facilities:</strong> Excellent</span>
                        <span class="badge success">95%</span>
                    </div>
                </div>
            </div>

            <!-- Emergency Contacts Section -->
            <div id="emergencySection" class="form-section hidden">
                <h3>üìû Emergency Contacts</h3>
                <div style="margin-top: 20px;">
                    <div class="list-item">
                        <div>
                            <strong>üöî Police</strong><br>
                            <span style="color: #666;">Emergency Response</span>
                        </div>
                        <a href="tel:100" style="color: #667eea; font-weight: bold; text-decoration: none;">100</a>
                    </div>
                    <div class="list-item">
                        <div>
                            <strong>üöë Ambulance</strong><br>
                            <span style="color: #666;">Medical Emergency</span>
                        </div>
                        <a href="tel:102" style="color: #667eea; font-weight: bold; text-decoration: none;">102</a>
                    </div>
                    <div class="list-item">
                        <div>
                            <strong>üî• Fire Service</strong><br>
                            <span style="color: #666;">Fire Emergency</span>
                        </div>
                        <a href="tel:101" style="color: #667eea; font-weight: bold; text-decoration: none;">101</a>
                    </div>
                    <div class="list-item">
                        <div>
                            <strong>üè• Tourist Helpline</strong><br>
                            <span style="color: #666;">24/7 Support</span>
                        </div>
                        <a href="tel:1363" style="color: #667eea; font-weight: bold; text-decoration: none;">1363</a>
                    </div>
                </div>
            </div>

            <!-- Itinerary Section -->
            <div id="itinerarySection" class="form-section hidden">
                <h3>üìÖ My Itinerary</h3>
                <div class="input-group">
                    <label>Location</label>
                    <input type="text" id="itineraryLocation" placeholder="Enter location">
                </div>
                <div class="input-group">
                    <label>Date & Time</label>
                    <input type="datetime-local" id="itineraryDateTime">
                </div>
                <div class="input-group">
                    <label>Notes</label>
                    <textarea id="itineraryNotes" placeholder="Add notes about this plan"></textarea>
                </div>
                <button class="btn" onclick="addItinerary()">Add to Itinerary</button>
                
                <div style="margin-top: 30px;">
                    <h4 style="margin-bottom: 15px;">Your Plans</h4>
                    <div id="itineraryList">
                        <div class="loading">Loading itinerary...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAadPtOI76iD47aCy4fsvOl6K6APHrEvNg",
            authDomain: "tourist-safety-sih.firebaseapp.com",
            projectId: "tourist-safety-sih",
            storageBucket: "tourist-safety-sih.firebasestorage.app",
            messagingSenderId: "693726857825",
            appId: "1:693726857825:web:24b18bed7fd1d51dc6f820"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        let currentUser = null;
        let currentRole = 'tourist';
        let map = null;
        let markers = [];

        // Role Selection
        document.querySelectorAll('.role-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.role-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentRole = this.dataset.role;
            });
        });

        // Form Navigation
        document.getElementById('showSignup')?.addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('signupSection').style.display = 'flex';
            document.getElementById('forgotPasswordSection').style.display = 'none';
        });

        document.getElementById('showLogin')?.addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('loginSection').style.display = 'flex';
            document.getElementById('signupSection').style.display = 'none';
            document.getElementById('forgotPasswordSection').style.display = 'none';
        });

        document.getElementById('backToLogin')?.addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('loginSection').style.display = 'flex';
            document.getElementById('signupSection').style.display = 'none';
            document.getElementById('forgotPasswordSection').style.display = 'none';
        });

        document.getElementById('showForgotPassword')?.addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('signupSection').style.display = 'none';
            document.getElementById('forgotPasswordSection').style.display = 'flex';
        });

        // Role selector for signup
        document.querySelectorAll('#signupSection .role-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('#signupSection .role-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Signup
        document.getElementById('signupBtn')?.addEventListener('click', async () => {
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            const role = document.querySelector('#signupSection .role-btn.active').dataset.role;

            // Validation
            if (!name || !email || !password || !confirmPassword) {
                alert('Please fill all fields');
                return;
            }

            if (password.length < 6) {
                alert('Password must be at least 6 characters long');
                return;
            }

            if (password !== confirmPassword) {
                alert('Passwords do not match');
                return;
            }

            if (!email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)) {
                alert('Please enter a valid email address');
                return;
            }

            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;

                // Save user data to Firestore
                await db.collection('users').doc(user.uid).set({
                    name,
                    email,
                    role,
                    createdAt: new Date(),
                    status: 'active'
                });

                // Update profile
                await user.updateProfile({ displayName: name });

                alert('Account created successfully! Please login.');
                
                // Switch to login
                document.getElementById('loginSection').style.display = 'flex';
                document.getElementById('signupSection').style.display = 'none';
                
                // Pre-fill login email
                document.getElementById('loginEmail').value = email;
            } catch (error) {
                alert('Signup failed: ' + error.message);
                console.error(error);
            }
        });

        // Forgot Password
        document.getElementById('resetBtn')?.addEventListener('click', async () => {
            const email = document.getElementById('resetEmail').value;

            if (!email) {
                alert('Please enter your email address');
                return;
            }

            if (!email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)) {
                alert('Please enter a valid email address');
                return;
            }

            try {
                await auth.sendPasswordResetEmail(email);
                alert('Password reset email sent! Please check your inbox.');
                
                // Switch to login
                document.getElementById('loginSection').style.display = 'flex';
                document.getElementById('forgotPasswordSection').style.display = 'none';
            } catch (error) {
                alert('Failed to send reset email: ' + error.message);
                console.error(error);
            }
        });

        // Login
        document.getElementById('loginBtn').addEventListener('click', async () => {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                alert('Please enter email and password');
                return;
            }

            try {
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                currentUser = userCredential.user;
                
                // Get user role from Firestore
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                const userData = userDoc.data();
                
                if (userData && userData.role === currentRole) {
                    showDashboard(currentRole);
                } else {
                    alert('Invalid credentials for selected role');
                    await auth.signOut();
                }
            } catch (error) {
                alert('Login failed: ' + error.message);
                console.error(error);
            }
        });

        // Auth State Observer
        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
            }
        });

        // Show Dashboard
        function showDashboard(role) {
            document.getElementById('loginSection').classList.add('hidden');
            
            if (role === 'authority') {
                document.getElementById('authorityDashboard').style.display = 'block';
                document.getElementById('authorityUserName').textContent = currentUser.email;
                initAuthorityDashboard();
            } else {
                document.getElementById('touristDashboard').style.display = 'block';
                document.getElementById('touristUserName').textContent = currentUser.email;
                initTouristDashboard();
            }
        }

        // Logout
        function logout() {
            auth.signOut();
            location.reload();
        }

        // Initialize Authority Dashboard
        function initAuthorityDashboard() {
            // Initialize Map
            setTimeout(() => {
                map = L.map('map').setView([28.6139, 77.2090], 12);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© OpenStreetMap contributors'
                }).addTo(map);

                // Load tourists on map
                loadTouristsOnMap();
            }, 500);

            // Load statistics
            loadStatistics();
            
            // Load tourist list
            loadTouristList();
            
            // Load alerts
            loadAlerts('alertsList');

            // Real-time updates for alerts
            db.collection('alerts').orderBy('timestamp', 'desc').limit(10)
                .onSnapshot(snapshot => {
                    loadAlerts('alertsList');
                });
            
            // Real-time updates for tourists
            db.collection('tourists').onSnapshot(snapshot => {
                loadTouristList();
                loadTouristsOnMap();
                loadStatistics();
            });
        }

        // Initialize Tourist Dashboard
        let touristMap = null;
        let touristMarker = null;
        let nearbyMarkers = [];
        let currentTouristLocation = null;

        function initTouristDashboard() {
            loadAlerts('touristAlertsList');
            loadItinerary();
            calculateSafetyScore();

            // Initialize tourist map
            setTimeout(() => {
                initTouristMap();
            }, 500);

            // Real-time alerts
            db.collection('alerts').orderBy('timestamp', 'desc').limit(5)
                .onSnapshot(snapshot => {
                    loadAlerts('touristAlertsList');
                });

            // Real-time itinerary
            db.collection('itinerary')
                .where('touristId', '==', currentUser.uid)
                .onSnapshot(snapshot => {
                    loadItinerary();
                });
        }

        // Initialize Tourist Map
        function initTouristMap() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        currentTouristLocation = [lat, lng];

                        // Create map centered on user's location
                        touristMap = L.map('touristMap').setView([lat, lng], 14);
                        
                        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                            attribution: '¬© OpenStreetMap contributors'
                        }).addTo(touristMap);

                        // Add marker for user's location
                        const userIcon = L.divIcon({
                            className: 'custom-div-icon',
                            html: "<div style='background-color:#4285f4; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);'></div>",
                            iconSize: [20, 20],
                            iconAnchor: [10, 10]
                        });

                        touristMarker = L.marker([lat, lng], { icon: userIcon })
                            .addTo(touristMap)
                            .bindPopup('<strong>üìç Your Location</strong>')
                            .openPopup();

                        // Update location in Firestore
                        updateTouristLocation(lat, lng);
                    },
                    (error) => {
                        console.error('Error getting location:', error);
                        // Default to Delhi if location access denied
                        touristMap = L.map('touristMap').setView([28.6139, 77.2090], 12);
                        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                            attribution: '¬© OpenStreetMap contributors'
                        }).addTo(touristMap);
                        alert('Please enable location access to see your position on the map');
                    }
                );
            } else {
                alert('Geolocation is not supported by your browser');
            }
        }

        // Update Tourist Location in Firestore
        async function updateTouristLocation(lat, lng) {
            try {
                await db.collection('tourists').doc(currentUser.uid).set({
                    userId: currentUser.uid,
                    email: currentUser.email,
                    location: new firebase.firestore.GeoPoint(lat, lng),
                    lastUpdate: firebase.firestore.FieldValue.serverTimestamp(),
                    status: 'active'
                }, { merge: true });
            } catch (error) {
                console.error('Error updating location:', error);
            }
        }

        // Center Map on Tourist Location
        function centerTouristMap() {
            if (touristMap && currentTouristLocation) {
                touristMap.setView(currentTouristLocation, 14);
                if (touristMarker) {
                    touristMarker.openPopup();
                }
            } else {
                alert('Getting your current location...');
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition((position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        currentTouristLocation = [lat, lng];
                        touristMap.setView([lat, lng], 14);
                        
                        if (touristMarker) {
                            touristMarker.setLatLng([lat, lng]);
                        }
                        
                        updateTouristLocation(lat, lng);
                    });
                }
            }
        }

        // Find Nearby Places on Map
        function findNearbyOnMap(category) {
            if (!currentTouristLocation) {
                alert('Please enable location access first');
                return;
            }

            // Clear existing nearby markers
            nearbyMarkers.forEach(marker => touristMap.removeLayer(marker));
            nearbyMarkers = [];

            // Mock nearby places data (in production, use Google Places API or Overpass API)
            const mockPlaces = {
                hospital: [
                    { name: 'City Hospital', lat: currentTouristLocation[0] + 0.01, lng: currentTouristLocation[1] + 0.01, phone: 'üìû +91-123-456-7890' },
                    { name: 'Medical Center', lat: currentTouristLocation[0] - 0.015, lng: currentTouristLocation[1] + 0.02, phone: 'üìû +91-123-456-7891' },
                    { name: 'Emergency Clinic', lat: currentTouristLocation[0] + 0.02, lng: currentTouristLocation[1] - 0.01, phone: 'üìû +91-123-456-7892' }
                ],
                police: [
                    { name: 'Central Police Station', lat: currentTouristLocation[0] + 0.008, lng: currentTouristLocation[1] - 0.012, phone: 'üìû 100' },
                    { name: 'Tourist Police', lat: currentTouristLocation[0] - 0.01, lng: currentTouristLocation[1] - 0.015, phone: 'üìû 1363' },
                    { name: 'Police Outpost', lat: currentTouristLocation[0] + 0.018, lng: currentTouristLocation[1] + 0.008, phone: 'üìû 100' }
                ],
                tourist_attraction: [
                    { name: 'Historical Monument', lat: currentTouristLocation[0] + 0.025, lng: currentTouristLocation[1] + 0.015, phone: '‚≠ê 4.5/5' },
                    { name: 'Museum', lat: currentTouristLocation[0] - 0.02, lng: currentTouristLocation[1] + 0.025, phone: '‚≠ê 4.7/5' },
                    { name: 'Garden Park', lat: currentTouristLocation[0] + 0.015, lng: currentTouristLocation[1] - 0.02, phone: '‚≠ê 4.3/5' }
                ],
                restaurant: [
                    { name: 'Local Cuisine Restaurant', lat: currentTouristLocation[0] + 0.005, lng: currentTouristLocation[1] + 0.008, phone: '‚≠ê 4.2/5' },
                    { name: 'Fine Dining', lat: currentTouristLocation[0] - 0.012, lng: currentTouristLocation[1] + 0.01, phone: '‚≠ê 4.8/5' },
                    { name: 'Street Food Corner', lat: currentTouristLocation[0] + 0.008, lng: currentTouristLocation[1] - 0.015, phone: '‚≠ê 4.0/5' }
                ]
            };

            const places = mockPlaces[category] || [];
            const icons = {
                hospital: 'üè•',
                police: 'üöî',
                tourist_attraction: 'üèõÔ∏è',
                restaurant: 'üçΩÔ∏è'
            };

            places.forEach(place => {
                const marker = L.marker([place.lat, place.lng])
                    .addTo(touristMap)
                    .bindPopup(`<strong>${icons[category]} ${place.name}</strong><br>${place.phone}<br><small>~${(Math.random() * 2 + 0.5).toFixed(1)} km away</small>`);
                
                nearbyMarkers.push(marker);
            });

            // Fit map to show all markers
            const group = L.featureGroup([touristMarker, ...nearbyMarkers]);
            touristMap.fitBounds(group.getBounds().pad(0.1));

            alert(`Found ${places.length} ${category.replace('_', ' ')}(s) nearby!`);
        }

        // Load Statistics
        async function loadStatistics() {
            try {
                const touristsSnap = await db.collection('tourists').get();
                document.getElementById('activeTourists').textContent = touristsSnap.size;

                const alertsSnap = await db.collection('alerts')
                    .where('status', '==', 'active').get();
                document.getElementById('activeAlerts').textContent = alertsSnap.size;

                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const incidentsSnap = await db.collection('incidents')
                    .where('timestamp', '>=', today).get();
                document.getElementById('incidentsToday').textContent = incidentsSnap.size;
            } catch (error) {
                console.error('Error loading statistics:', error);
            }
        }

        // Load Tourists on Map
        async function loadTouristsOnMap() {
            if (!map) return;

            markers.forEach(marker => map.removeLayer(marker));
            markers = [];

            try {
                const snapshot = await db.collection('tourists').get();
                
                if (snapshot.empty) {
                    console.log('No tourists found in database');
                    return;
                }
                
                snapshot.forEach(doc => {
                    const tourist = doc.data();
                    if (tourist.location) {
                        const lat = tourist.location.latitude || tourist.location._lat;
                        const lng = tourist.location.longitude || tourist.location._long;
                        
                        const marker = L.marker([lat, lng]).addTo(map);
                        
                        const lastUpdate = tourist.lastUpdate ? 
                            new Date(tourist.lastUpdate.toDate ? tourist.lastUpdate.toDate() : tourist.lastUpdate).toLocaleString() : 
                            'Unknown';
                        
                        marker.bindPopup(`
                            <strong>üìç Tourist</strong><br>
                            Email: ${tourist.email || 'N/A'}<br>
                            Status: ${tourist.status || 'Active'}<br>
                            <small>Last updated: ${lastUpdate}</small>
                        `);
                        
                        markers.push(marker);
                    }
                });
                
                console.log(`Loaded ${markers.length} tourists on map`);
            } catch (error) {
                console.error('Error loading tourists on map:', error);
            }
        }
        
        // Load Tourist List
        async function loadTouristList() {
            const container = document.getElementById('touristsList');
            if (!container) return;
            
            try {
                const snapshot = await db.collection('tourists').get();
                
                if (snapshot.empty) {
                    container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No tourists found. Tourists will appear here when they login and enable location tracking.</p>';
                    return;
                }
                
                let html = '';
                snapshot.forEach(doc => {
                    const tourist = doc.data();
                    const lastUpdate = tourist.lastUpdate ? 
                        new Date(tourist.lastUpdate.toDate ? tourist.lastUpdate.toDate() : tourist.lastUpdate).toLocaleString() : 
                        'Never';
                    
                    let locationText = 'Location not available';
                    if (tourist.location) {
                        const lat = (tourist.location.latitude || tourist.location._lat || 0).toFixed(4);
                        const lng = (tourist.location.longitude || tourist.location._long || 0).toFixed(4);
                        locationText = `${lat}, ${lng}`;
                    }
                    
                    const statusBadge = tourist.status === 'sos' ? 
                        '<span class="badge danger">SOS</span>' : 
                        '<span class="badge success">Active</span>';
                    
                    html += `
                        <div class="list-item">
                            <div>
                                <strong>üë§ ${tourist.email || 'Unknown Tourist'}</strong><br>
                                <span style="color: #666; font-size: 14px;">
                                    üìç ${locationText}<br>
                                    üïê ${lastUpdate}
                                </span>
                            </div>
                            ${statusBadge}
                        </div>
                    `;
                });
                
                container.innerHTML = html;
                console.log(`Loaded ${snapshot.size} tourists in list`);
            } catch (error) {
                console.error('Error loading tourist list:', error);
                container.innerHTML = '<p style="color: #dc3545;">Error loading tourists. Check console for details.</p>';
            }
        }

        // Load Alerts
        async function loadAlerts(elementId) {
            const container = document.getElementById(elementId);
            
            try {
                const snapshot = await db.collection('alerts')
                    .orderBy('timestamp', 'desc')
                    .limit(elementId === 'touristAlertsList' ? 5 : 10)
                    .get();

                if (snapshot.empty) {
                    container.innerHTML = '<p style="color: #666; text-align: center;">No alerts</p>';
                    return;
                }

                container.innerHTML = '';
                snapshot.forEach(doc => {
                    const alert = doc.data();
                    const div = document.createElement('div');
                    div.className = `alert-item ${alert.severity}`;
                    div.innerHTML = `
                        <strong>${alert.title}</strong>
                        <p style="margin: 8px 0; color: #666;">${alert.message}</p>
                        <small style="color: #999;">${new Date(alert.timestamp?.toDate()).toLocaleString()}</small>
                    `;
                    container.appendChild(div);
                });
            } catch (error) {
                console.error('Error loading alerts:', error);
                container.innerHTML = '<p style="color: #dc3545;">Error loading alerts</p>';
            }
        }

        // Broadcast Alert
        async function broadcastAlert() {
            const title = document.getElementById('alertTitle').value;
            const message = document.getElementById('alertMessage').value;
            const severity = document.getElementById('alertSeverity').value;

            if (!title || !message) {
                alert('Please fill in all fields');
                return;
            }

            try {
                await db.collection('alerts').add({
                    title,
                    message,
                    severity,
                    status: 'active',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    authorityId: currentUser.uid
                });

                alert('Alert broadcasted successfully!');
                document.getElementById('alertTitle').value = '';
                document.getElementById('alertMessage').value = '';
            } catch (error) {
                alert('Error broadcasting alert: ' + error.message);
            }
        }

        // Send SOS
        async function sendSOS() {
            if (!confirm('Send SOS Alert? This will notify authorities immediately.')) {
                return;
            }

            try {
                const position = await new Promise((resolve, reject) => {
                    navigator.geolocation.getCurrentPosition(resolve, reject);
                });

                await db.collection('alerts').add({
                    title: 'SOS ALERT',
                    message: `Emergency SOS from ${currentUser.email}`,
                    severity: 'high',
                    status: 'active',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    touristId: currentUser.uid,
                    location: {
                        latitude: position.coords.latitude,
                        longitude: position.coords.longitude
                    }
                });

                alert('SOS sent! Authorities have been notified.');
            } catch (error) {
                alert('Error sending SOS: ' + error.message);
            }
        }

        // Calculate Safety Score
        async function calculateSafetyScore() {
            // Mock calculation - in real app, this would use location data
            const score = 85;
            document.getElementById('safetyScore').textContent = score + '%';
        }

        // Show Section
        function showSection(section) {
            document.querySelectorAll('.form-section').forEach(s => s.classList.add('hidden'));
            document.getElementById(section + 'Section').classList.remove('hidden');
        }

        // Add Itinerary
        async function addItinerary() {
            const location = document.getElementById('itineraryLocation').value;
            const dateTime = document.getElementById('itineraryDateTime').value;
            const notes = document.getElementById('itineraryNotes').value;

            if (!location || !dateTime) {
                alert('Please fill in location and date/time');
                return;
            }

            try {
                await db.collection('itinerary').add({
                    touristId: currentUser.uid,
                    location,
                    dateTime: new Date(dateTime),
                    notes,
                    status: 'planned',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                alert('Added to itinerary!');
                document.getElementById('itineraryLocation').value = '';
                document.getElementById('itineraryDateTime').value = '';
                document.getElementById('itineraryNotes').value = '';
                loadItinerary();
            } catch (error) {
                alert('Error adding itinerary: ' + error.message);
            }
        }

        // Load Itinerary
        async function loadItinerary() {
            const container = document.getElementById('itineraryList');
            
            try {
                const snapshot = await db.collection('itinerary')
                    .where('touristId', '==', currentUser.uid)
                    .orderBy('dateTime', 'asc')
                    .get();

                if (snapshot.empty) {
                    container.innerHTML = '<p style="color: #666; text-align: center;">No plans yet</p>';
                    return;
                }

                container.innerHTML = '';
                snapshot.forEach(doc => {
                    const item = doc.data();
                    const div = document.createElement('div');
                    div.className = 'list-item';
                    div.innerHTML = `
                        <div>
                            <strong>${item.location}</strong><br>
                            <small style="color: #666;">${new Date(item.dateTime.toDate()).toLocaleString()}</small>
                            ${item.notes ? '<br><small>' + item.notes + '</small>' : ''}
                        </div>
                        <span class="badge ${item.status === 'completed' ? 'success' : 'warning'}">${item.status}</span>
                    `;
                    container.appendChild(div);
                });
            } catch (error) {
                console.error('Error loading itinerary:', error);
                container.innerHTML = '<p style="color: #dc3545;">Error loading itinerary</p>';
            }
        }

        // Safety Tips Modal Functions
        function showSafetyTips() {
            document.getElementById('safetyTipsModal').style.display = 'flex';
        }

        function closeSafetyTips() {
            document.getElementById('safetyTipsModal').style.display = 'none';
        }

        // Export Tourist Data
        function exportTouristData() {
            const tourists = document.querySelectorAll('#touristsList .list-item');
            let csvContent = "Name,Email,Location,Status,Last Updated\n";
            
            tourists.forEach(tourist => {
                const name = tourist.querySelector('strong').textContent;
                const details = tourist.textContent.split('\n').filter(t => t.trim());
                csvContent += `${details.join(',')}\n`;
            });

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `tourists_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
        }

        // Add Itinerary Item
        async function addItineraryItem() {
            const place = document.getElementById('itineraryPlace').value;
            const date = document.getElementById('itineraryDate').value;
            const time = document.getElementById('itineraryTime').value;

            if (!place || !date || !time) {
                alert('Please fill all fields');
                return;
            }

            try {
                await addDoc(collection(db, 'itineraries'), {
                    userId: auth.currentUser.uid,
                    place,
                    date,
                    time,
                    createdAt: new Date(),
                    completed: false
                });

                document.getElementById('itineraryPlace').value = '';
                document.getElementById('itineraryDate').value = '';
                document.getElementById('itineraryTime').value = '';
                
                loadItinerary();
                alert('Itinerary item added successfully!');
            } catch (error) {
                console.error('Error adding itinerary:', error);
                alert('Failed to add itinerary item');
            }
        }

        // Find Nearby Places (Mock implementation - integrate with real API)
        function findNearbyPlaces() {
            const category = document.getElementById('placeCategory').value;
            const container = document.getElementById('nearbyPlaces');
            
            const mockPlaces = {
                hospital: [
                    { name: 'City Hospital', distance: '1.2 km', phone: '+91-123-456-7890' },
                    { name: 'Medical Center', distance: '2.5 km', phone: '+91-123-456-7891' }
                ],
                police: [
                    { name: 'Central Police Station', distance: '0.8 km', phone: '100' },
                    { name: 'Tourist Police', distance: '1.5 km', phone: '1363' }
                ],
                tourist: [
                    { name: 'Historical Monument', distance: '3.2 km', rating: '4.5‚òÖ' },
                    { name: 'Museum', distance: '4.0 km', rating: '4.7‚òÖ' }
                ],
                restaurant: [
                    { name: 'Local Cuisine Restaurant', distance: '0.5 km', rating: '4.2‚òÖ' },
                    { name: 'Fine Dining', distance: '1.8 km', rating: '4.8‚òÖ' }
                ]
            };

            const places = mockPlaces[category] || [];
            container.innerHTML = places.map(place => `
                <div class="list-item">
                    <div>
                        <strong>${place.name}</strong><br>
                        <span style="color: #666; font-size: 14px;">${place.distance} ${place.phone || place.rating || ''}</span>
                    </div>
                    <button class="btn" style="padding: 5px 15px; font-size: 14px;">Navigate</button>
                </div>
            `).join('');
        }

        // Search and Filter Tourists
        document.getElementById('searchTourist')?.addEventListener('input', filterTourists);
        document.getElementById('filterStatus')?.addEventListener('change', filterTourists);

        function filterTourists() {
            const searchTerm = document.getElementById('searchTourist')?.value.toLowerCase() || '';
            const filterStatus = document.getElementById('filterStatus')?.value || 'all';
            const tourists = document.querySelectorAll('#touristsList .list-item');

            tourists.forEach(tourist => {
                const text = tourist.textContent.toLowerCase();
                const matchesSearch = text.includes(searchTerm);
                const matchesFilter = filterStatus === 'all' || text.includes(filterStatus);
                
                tourist.style.display = matchesSearch && matchesFilter ? '' : 'none';
            });
        }
    </script>

    <!-- Safety Tips Modal -->
    <div id="safetyTipsModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 15px; max-width: 600px; max-height: 80vh; overflow-y: auto; margin: 20px;">
            <h2 style="color: #667eea; margin-bottom: 20px;">üìö Safety Tips for Tourists</h2>
            <div id="safetyTipsContent">
                <h3 style="color: #333; margin-top: 15px;">üõ°Ô∏è General Safety:</h3>
                <ul style="line-height: 2; color: #666;">
                    <li>Always keep your location tracking ON in this app</li>
                    <li>Save emergency numbers in your phone contacts</li>
                    <li>Inform family/friends about your itinerary regularly</li>
                    <li>Avoid isolated areas, especially after dark</li>
                    <li>Keep copies of important documents (passport, ID)</li>
                    <li>Stay in well-lit, populated areas</li>
                    <li>Use official taxis and transportation</li>
                </ul>
                
                <h3 style="color: #333; margin-top: 15px;">üìû Emergency Contacts:</h3>
                <ul style="line-height: 2; color: #666;">
                    <li><strong>Police:</strong> 100</li>
                    <li><strong>Ambulance:</strong> 102</li>
                    <li><strong>Fire:</strong> 101</li>
                    <li><strong>Tourist Helpline:</strong> 1363</li>
                    <li><strong>Women Helpline:</strong> 1091</li>
                    <li><strong>Disaster Management:</strong> 108</li>
                </ul>
                
                <h3 style="color: #333; margin-top: 15px;">üè• Health & Safety:</h3>
                <ul style="line-height: 2; color: #666;">
                    <li>Carry a first aid kit and essential medications</li>
                    <li>Stay hydrated, especially in hot weather</li>
                    <li>Be aware of local health advisories and diseases</li>
                    <li>Use sunscreen (SPF 30+) and protective clothing</li>
                    <li>Eat at clean, reputable restaurants</li>
                    <li>Keep travel insurance details handy</li>
                </ul>
                
                <h3 style="color: #333; margin-top: 15px;">üí∞ Money & Valuables:</h3>
                <ul style="line-height: 2; color: #666;">
                    <li>Don't carry large amounts of cash</li>
                    <li>Use hotel safes for valuables</li>
                    <li>Be discreet with expensive jewelry and electronics</li>
                    <li>Keep backup copies of credit cards</li>
                    <li>Beware of pickpockets in crowded areas</li>
                </ul>
                
                <h3 style="color: #333; margin-top: 15px;">üö® In Case of Emergency:</h3>
                <ul style="line-height: 2; color: #666;">
                    <li>Press the SOS button in this app immediately</li>
                    <li>Call local emergency services (100/102)</li>
                    <li>Contact your embassy or consulate</li>
                    <li>Move to a safe, public location</li>
                    <li>Don't panic - help is on the way</li>
                </ul>
            </div>
            <button class="btn" onclick="closeSafetyTips()" style="width: 100%; margin-top: 20px;">Close</button>
        </div>
    </div>
</body>
</html>

